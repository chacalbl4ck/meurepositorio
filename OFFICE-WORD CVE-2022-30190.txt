@echo off & setlocal enabledelayedexpansion
echo. 
echo ****************************************************************
echo PATCH FALHA CVE-2022-30190 OFFICE 2013/2016/2021
echo ****************************************************************
echo.
echo ESTA CORRECAO E PALIATIVA! RECOMENDA-SE ATUALIZAR SEU SOFTWARE!
echo.
:escolha
set /P c=Voce entende que este patch e paliativo e que o melhor a se fazer e atualizar seu software?[S/N]
if /I "%c%" EQU "S" goto :sim
if /I "%c%" EQU "N" goto :nao
goto :escolha
echo
timeout 5
echo.
echo.
:sim
echo ****************************************************************
echo ********** EFETUANDO BACKUP DO REGISTRO *************
echo ****************************************************************
reg export HKCR\ms-msdt ms-msdt_backup.reg
echo ****************************************************************
echo *********** BACKUP EFETUADO COM SUCESSO! ************
echo ****************************************************************
TIMEOUT 3
echo.
echo ****************************************************************
echo EFETUANDO O A CORRECAO DA FALHA 0DAY...
echo ****************************************************************
TIMEOUT 3
reg delete HKCR\ms-msdt /f
echo.
echo ****************************************************************
echo PROCESSO EXECUTADO, VERIFIQUE POSSIVEIS ERROS ACIMA.
echo ****************************************************************
Timeout 10
goto :end
:nao
echo ****************************************************************
echo VOCE OPTOU POR NAO FAZER O PATCH, O PROGRAMA IRA SE ENCERRAR E NENHUMA ALTERACAO FOI FEITA.
echo ****************************************************************
Timeout 10
goto :end
:end
END
